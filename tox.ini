[tox]
envlist = 
    ; clean
    py{38,39,310,311}-{linux,macos}
    report

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: py310
    3.11: py311

[gh-actions:env]
PLATFORM =
    ubuntu-latest: linux
    macos-latest: macos

[testenv]
deps =
    pytest
    coverage
commands = 
    coverage run --parallel --source squishyplanet --module pytest
    ; coverage report
    ; coverage xml -o {toxinidir}/coverage.xml
; commands = pytest --cov --cov-report xml

[testenv:report]
basepython = py311
commands =
    python -m coverage combine
    python -m coverage report -m --skip-covered
    python -m coverage xml -o {toxinidir}/coverage.xml

; [testenv:clean]
; deps = coverage
; depends = py38,py39,py310,py311
; skip_install = true
; commands = -coverage erase

; [testenv:report]
; basepython = py311
; deps = coverage
; ; depends = py38,py39,py310,py311
; parallel_show_output = true
; skip_install = true
; commands =
;     -coverage combine
;     -coverage report
;     -coverage xml